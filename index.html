<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>JARVIS Command Center</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet"
 href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>

@import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

*{box-sizing:border-box;}

body{
margin:0;
background:black;
font-family:Orbitron,sans-serif;
color:#00ffff;
overflow:hidden;
}

/* Header */
#top{
height:55px;
background:#000814;
border-bottom:2px solid cyan;
display:flex;
align-items:center;
justify-content:center;
box-shadow:0 0 15px cyan;
}

/* Status */
#status{
height:35px;
background:#020c18;
border-bottom:1px solid cyan;
text-align:center;
font-size:13px;
line-height:35px;
}

/* Map */
#map{
height:calc(100vh - 90px);
width:100%;
}

/* HUD */
#hud{
position:fixed;
inset:0;
pointer-events:none;
background:
repeating-linear-gradient(
0deg,
rgba(0,255,255,.04),
rgba(0,255,255,.04) 1px,
transparent 2px,
transparent 5px
);
animation:scan 4s linear infinite;
}

@keyframes scan{
to{background-position:0 120px;}
}

/* Controls */
#controls{
position:fixed;
bottom:10px;
left:50%;
transform:translateX(-50%);
display:flex;
gap:10px;
}

.btn{
background:black;
color:cyan;
border:2px solid cyan;
padding:8px 14px;
border-radius:20px;
font-size:11px;
box-shadow:0 0 10px cyan;
}

.btn:active{
background:cyan;
color:black;
}

/* Radar */
#radar{
position:fixed;
top:80px;
right:10px;
width:120px;
height:120px;
border:2px solid cyan;
border-radius:50%;
overflow:hidden;
box-shadow:0 0 20px cyan;
}

#sweep{
position:absolute;
width:100%;
height:100%;
background:
conic-gradient(
from 0deg,
rgba(0,255,255,.4),
transparent 60%
);
animation:spin 3s linear infinite;
}

@keyframes spin{
to{transform:rotate(360deg);}
}

</style>
</head>

<body>

<div id="top">J.A.R.V.I.S COMMAND CENTER</div>
<div id="status">Booting system...</div>

<div id="map"></div>

<div id="radar"><div id="sweep"></div></div>

<div id="controls">
<button class="btn" onclick="centerGPS()">CENTER</button>
<button class="btn" onclick="toggleSat()">SAT</button>
<button class="btn" onclick="speak()">VOICE</button>
<button class="btn" onclick="loadPlanes()">PLANES</button>
</div>

<div id="hud"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

let map,userMarker,lastPos=null;
let sat=false;
let planeMarkers=[];

// Map
map=L.map("map",{zoomControl:false})
.setView([20,0],2);

// Layers
const normal=L.tileLayer(
'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');

const satLayer=L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

normal.addTo(map);

// Icon
const userIcon=L.icon({
iconUrl:"https://cdn-icons-png.flaticon.com/512/149/149071.png",
iconSize:[32,32]
});

const status=document.getElementById("status");

// Voice
function speak(){
let t=new SpeechSynthesisUtterance(status.innerText);
speechSynthesis.speak(t);
}

// GPS
navigator.geolocation.watchPosition(

p=>{
let lat=p.coords.latitude;
let lng=p.coords.longitude;
lastPos=[lat,lng];

status.innerText=
"GPS LOCKED ‚ö° "+lat.toFixed(5)+" , "+lng.toFixed(5);

if(!userMarker){

userMarker=L.marker([lat,lng],{icon:userIcon})
.addTo(map);

map.setView([lat,lng],15);

}else{

userMarker.setLatLng([lat,lng]);

}

},

e=>{
status.innerText="GPS ERROR ‚ùå";
alert("Enable GPS");
},

{enableHighAccuracy:true}

);

// Center
function centerGPS(){
if(lastPos)
map.setView(lastPos,16,{animate:true});
}

// Satellite
function toggleSat(){

if(!sat){
map.removeLayer(normal);
satLayer.addTo(map);
sat=true;
status.innerText="Satellite Mode ON üõ∞Ô∏è";
}else{
map.removeLayer(satLayer);
normal.addTo(map);
sat=false;
status.innerText="Map Mode ON üåç";
}

}

// Planes
async function loadPlanes(){

status.innerText="Scanning Airspace ‚úàÔ∏è";

planeMarkers.forEach(m=>map.removeLayer(m));
planeMarkers=[];

try{

let url="https://api.allorigins.win/raw?url="+
encodeURIComponent("https://opensky-network.org/api/states/all");

let r=await fetch(url);
let d=await r.json();

d.states.forEach(p=>{

let lat=p[6],lng=p[5],id=p[1];

if(lat&&lng){

let m=L.marker([lat,lng])
.addTo(map)
.bindPopup("‚úàÔ∏è "+id);

planeMarkers.push(m);

}

});

status.innerText="Airspace Updated ‚úîÔ∏è";

}catch{
status.innerText="Plane Data Blocked ‚ùå";
}

}

// Auto planes refresh
setInterval(loadPlanes,20000);

</script>

</body>
</html>
