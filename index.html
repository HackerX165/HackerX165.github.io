<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>JARVIS AI Ultimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet"
href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>

@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

*{box-sizing:border-box;}

body{
margin:0;
background:radial-gradient(circle,#001018,#000);
font-family:Orbitron,sans-serif;
color:#00ffff;
overflow:hidden;
}

/* Top */
#top{
height:60px;
background:#000c18;
display:flex;
align-items:center;
justify-content:center;
border-bottom:2px solid cyan;
box-shadow:0 0 25px cyan;
}

/* Console */
#console{
height:40px;
background:#020f1f;
text-align:center;
line-height:40px;
border-bottom:1px solid cyan;
font-size:13px;
}

/* Map */
#map{
height:calc(100vh - 100px);
}

/* HUD */
#hud{
position:fixed;
inset:0;
pointer-events:none;
background:
linear-gradient(transparent 96%,rgba(0,255,255,.08)),
linear-gradient(90deg,transparent 96%,rgba(0,255,255,.08));
background-size:40px 40px;
opacity:.4;
}

/* AI Core */
#ai{
position:fixed;
top:100px;
right:15px;
width:110px;
height:110px;
border-radius:50%;
border:2px solid cyan;
box-shadow:0 0 30px cyan;
display:flex;
align-items:center;
justify-content:center;
font-size:11px;
animation:pulse 2s infinite;
}

@keyframes pulse{
50%{box-shadow:0 0 60px cyan;}
}

/* Panel */
#panel{
position:fixed;
bottom:15px;
left:50%;
transform:translateX(-50%);
display:flex;
flex-wrap:wrap;
gap:8px;
justify-content:center;
}

.btn{
background:black;
color:cyan;
border:2px solid cyan;
padding:7px 14px;
border-radius:20px;
font-size:11px;
box-shadow:0 0 12px cyan;
}

.btn:active{
background:cyan;
color:black;
}

/* Compass */
#compass{
position:fixed;
top:100px;
left:15px;
width:80px;
height:80px;
border-radius:50%;
border:2px solid cyan;
text-align:center;
line-height:80px;
font-size:18px;
box-shadow:0 0 20px cyan;
}

</style>
</head>

<body>

<div id="top">J.A.R.V.I.S AI COMMAND SYSTEM</div>
<div id="console">Booting AI Core...</div>

<div id="map"></div>

<div id="ai">AI CORE</div>
<div id="compass">N</div>

<div id="panel">

<button class="btn" onclick="center()">CENTER</button>
<button class="btn" onclick="toggleSat()">SAT</button>
<button class="btn" onclick="listen()">CMD</button>
<button class="btn" onclick="speak()">TALK</button>
<button class="btn" onclick="loadPlanes()">PLANES</button>
<button class="btn" onclick="getWeather()">WEATHER</button>
<button class="btn" onclick="sos()">SOS</button>

</div>

<div id="hud"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

let map,userMarker,lastPos=null;
let sat=false;
let planes=[];
let heading=0;

const consoleBox=document.getElementById("console");
const compass=document.getElementById("compass");

// Map
map=L.map("map",{zoomControl:false})
.setView([20,0],2);

const normal=L.tileLayer(
'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');

const satLayer=L.tileLayer(
'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

normal.addTo(map);

// Icon
const icon=L.icon({
iconUrl:"https://cdn-icons-png.flaticon.com/512/149/149071.png",
iconSize:[32,32]
});

// Voice
function say(t){
let s=new SpeechSynthesisUtterance(t);
s.rate=1;
speechSynthesis.speak(s);
}

function speak(){
say(consoleBox.innerText);
}

// GPS
navigator.geolocation.watchPosition(p=>{

let lat=p.coords.latitude;
let lng=p.coords.longitude;

lastPos=[lat,lng];

consoleBox.innerText=
"GPS ⚡ "+lat.toFixed(5)+" , "+lng.toFixed(5);

if(!userMarker){

userMarker=L.marker([lat,lng],{icon})
.addTo(map);

map.setView([lat,lng],15);

say("Location locked");

}else{

userMarker.setLatLng([lat,lng]);

}

},

e=>{
consoleBox.innerText="GPS ERROR";
say("GPS error");
},

{enableHighAccuracy:true}

);

// Center
function center(){
if(lastPos){
map.setView(lastPos,16);
say("Centered");
}
}

// Satellite
function toggleSat(){

if(!sat){
map.removeLayer(normal);
satLayer.addTo(map);
sat=true;
consoleBox.innerText="Satellite ON";
say("Satellite enabled");
}else{
map.removeLayer(satLayer);
normal.addTo(map);
sat=false;
consoleBox.innerText="Map Mode";
say("Map enabled");
}

}

// Voice Commands
function listen(){

const SR=window.SpeechRecognition||
window.webkitSpeechRecognition;

if(!SR){
alert("Voice not supported");
return;
}

const r=new SR();
r.lang="en-US";
r.start();

consoleBox.innerText="Listening...";

r.onresult=e=>{

let cmd=e.results[0][0].transcript
.toLowerCase();

consoleBox.innerText="CMD: "+cmd;

if(cmd.includes("center")) center();
if(cmd.includes("satellite")) toggleSat();
if(cmd.includes("map")) toggleSat();
if(cmd.includes("weather")) getWeather();
if(cmd.includes("sos")) sos();

};

}

// Weather (free API)
async function getWeather(){

if(!lastPos){
alert("No GPS");
return;
}

let lat=lastPos[0];
let lng=lastPos[1];

try{

let url=
`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lng}&current_weather=true`;

let r=await fetch(url);
let d=await r.json();

let t=d.current_weather.temperature;
let w=d.current_weather.windspeed;

let msg=
"Weather: "+t+"°C | Wind "+w+" km/h";

consoleBox.innerText=msg;
say(msg);

}catch{
consoleBox.innerText="Weather error";
}

}

// Planes
async function loadPlanes(){

consoleBox.innerText="Scanning planes...";

planes.forEach(p=>map.removeLayer(p));
planes=[];

try{

let url="https://api.allorigins.win/raw?url="+
encodeURIComponent("https://opensky-network.org/api/states/all");

let r=await fetch(url);
let d=await r.json();

d.states.forEach(p=>{

let lat=p[6],lng=p[5];

if(lat&&lng){

let m=L.marker([lat,lng])
.addTo(map)
.bindPopup("✈️ "+p[1]);

planes.push(m);

}

});

consoleBox.innerText="Airspace updated";
say("Planes updated");

}catch{

consoleBox.innerText="Plane blocked";

}

}

setInterval(loadPlanes,25000);

// Compass
window.addEventListener("deviceorientation",e=>{

if(e.alpha!=null){

heading=Math.round(e.alpha);
compass.innerText=heading+"°";

}

});

// SOS
function sos(){

if(!lastPos){
alert("No GPS");
return;
}

let msg=
"EMERGENCY SOS! Location: "+
lastPos[0]+","+lastPos[1];

say("Emergency signal activated");

alert(msg);

}

say("Jarvis system online");

</script>

</body>
</html>
